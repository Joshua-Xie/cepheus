---
# RHEL specific data

# IMPORTANT: Whatever data is here will be appended to the overall `build.yaml` that will be located `public` or
# `private` based on the value passed to the intial ./CEPH_UP script

# IMPORTANT: No section below can exist in other yaml files be used in the files being appended. For example,
# 'os' section can not already exist in 'build.yaml'. However, it can and should be in other OS related yaml files.

os:
    type: rhel
    version: 7.2
    name: rhel-7.2
    arch: x86_64
    distro: rhel-server-7.2-x86_64.iso
    breed: redhat
    # pxe_boot file extension - This will get used when creating the OS specific kickstart file using the profile name and this extension
    kickstart_ext: ks
    iso:
        url: http://mirror.es.its.nyu.edu/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1611.iso

# Unique ISO data for OS
ISO:
  volume_id: "RHEL-7.2 Server.x86_64"

{% if environment == "vagrant" %}
# Name of the VBox Storage Controller
vagrant:
    storage_controller: "SATA Controller"
    box: "bento/centos-7.1"
{% endif %}

# Subscription Manager - Satellite Server
subscription:
    enable: true
    # Can only be 'sat' or 'rhn'
    type: sat
    server: rhncapsule.repo.example.com
    key: cloud-storage-example-x86_64-server-7.2
    commands:
        C1: "curl -k -O http://rhnsat.example.com/pub/katello-ca-consumer-latest.noarch.rpm && rpm -Uvh ./katello-ca-consumer-latest.noarch.rpm"
        C2: "subscription-manager register --activationkey cloud-storage-example-x86_64-server-7.2 --org \"EXAMPLE\" --force"
        {#- This gets ran through the template engine before being processed #}
        C3: "ls /ceph-host/data/{{ location }}/{{ data_center }}/*.key | xargs rpm --import"

chef_repo: # (required files for build)
    knife_acl_version: 0.0.12
    client:
        version: 12.19.36
        package: chef-12.19.36-1.el7.x86_64.rpm
    server:
        version: 12.14.0
        package: chef-server-core-12.14.0-1.el7.x86_64.rpm

adc_repo: # (optional) Only required if allowing Cepheus to build out your software load-balancers
    bgp:
        bird: # (required files for build)
            version: 1.5.0
            package: bird-1.5.0-1.x86_64.rpm

ceph_repo:
    branch: stable
    arch: x86_64
    revision: 0.el7

security:
    sshd:
        permit_root_login: "no"
        login_grace_time: "2m"
        max_auth_tries: 6
        max_sessions: 10
        banner: "/etc/banner"

    firewall:
        enable: false
        use: rules
        zone: public
        rules:
            - name: ceph
              roles:
                  - ceph-mon
                  - ceph-osd
                  - ceph-rgd
                  - ceph-rgw
                  - ceph-mds
                  - ceph-admin
                  - ceph-restapi
                  - ceph-adc
              type: rich-rule
              zone: public
              permanent: true
              rules:
                  - "rule family='ipv4' source address='10.0.100.0/24' accept"
                  - "rule family='ipv4' source address='10.0.100.0/24' service name='ssh' accept"

            ## All of the ones below are examples. You can get creative.
            # - name: ceph-osd
            #   roles:
            #       - ceph-osd
            #   type: rich-rule
            #   zone: public
            #   permanent: true
            #   rules:
            #       - "rule family='ipv4' source address='10.0.100.0/24' accept"
            # - name: ceph-rgw
            #   roles:
            #       - ceph-rgw
            #   type: rich-rule
            #   zone: public
            #   permanent: true
            #   rules:
            #       - "rule family='ipv4' source address='10.0.100.0/24' port port='8080-8089' protocol='tcp' accept"
            # - name: ssh
            #   roles:
            #       - ceph-bootstrap
            #       - ceph-mon
            #       - ceph-osd
            #       - ceph-rgd
            #       - ceph-rgw
            #       - ceph-mds
            #       - ceph-admin
            #       - ceph-restapi
            #       - ceph-adc
            #   type: service
            #   zone: public
            #   permanent: true
            #   rules:
            #       - ssh
            # - name: bootstrap-internal
            #   roles:
            #       - ceph-bootstrap
            #   type: rich-rule
            #   zone: public
            #   permanent: true
            #   rules:
            #       - "rule family='ipv4' source address='10.0.100.0/24' accept"
            # - name: adc
            #   roles:
            #       - ceph-adc
            #   type: service
            #   zone: public
            #   permanent: true
            #   rules:
            #       - http
            #       - https
            ##
